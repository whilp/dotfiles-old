#################  BEGIN HEADERS
# Filename	: $HOME/.mailfilter
# Use		: configures routing of incoming mail
# Author	: Will Maier <willmaier@ml1.net>
# Vim		: vim: set ft=perl:
# Copyright	: Copyright (c) 2005, 2006 Will Maier
# License	: Expat; see <http://www.opensource.org/licenses/mit-license.php>
##################  END HEADERS

# SETTINGS
HOME    = '/home/will'
MAILDIR = "$HOME/.maildir"
LOG     = "$MAILDIR/drop.log"
DEFAULT = "$MAILDIR/Inbox/"

# FOLDERS
HEP     = "$MAILDIR/HEP"
UW      = "$MAILDIR/UW/"
LUG     = "$MAILDIR/LUG"
FOSS    = "$MAILDIR/FOSS"
OBSD    = "$MAILDIR/OBSD"
BSD     = "$MAILDIR/BSD"
LINUX   = "$MAILDIR/Linux"
UBUNTU  = "$LINUX/Ubuntu"

IN      = "$DEFAULT"
SENT    = "$MAILDIR/Sent/"
SPAM    = "$MAILDIR/Spam/"
JUNK    = "$MAILDIR/Junk/"

CAE     = "$MAILDIR/CAE/"
FAMILY  = "$MAILDIR/Family/"
FRIEND  = "$MAILDIR/Friend/"
SCHOOL  = "$MAILDIR/School/"

logfile $LOG

FILTERDIR = "$HOME/.mailfilters"

# Test for spam.
exception {
    # All mail gets run through relaydb(1), which builds a list of
}
exception {
    # Filter through bmf(1).
    xfilter "bmf -p"
    if (/^X-Spam-Status: Yes/)
    {
        # This should be enabled when bmf is better at identifying
        # spam.
        #exception {
        #    # Blacklist relays using relaydb(1).
        #    xfilter "relaydb -b"
        #}
        to "$SPAM"
    }
}

# Lists
if ( /^List/ || \
    /^Sender:/ || \
    /^Mailing-List:.*zsh/ || \
    /^Mailing-List:.*vim/ )
{
    include "$FILTERDIR/lists"
}
if ( /^From:.*sec-adv@secunia\.com/ )
{
    to "$MAILDIR/SEC/Secunia/"
}

# --[ FAMILY
if ( \
    /^From:.*ajdj143@sbcglobal\.net/ || \
    /^From:.*beachbumbutterfly@yahoo\.com/ || \
    /^From:.*ginaryan@aol\.com/ || \
    /^From:.*jacobsonlaura@(hotmail|gmail)\.com/ || \
    /^From:.*ljacobson@(biochem\.wisc\.edu|deltanoid.com)/ || \
    /^From:.*linuxmaier@fastmail\.fm/ || \
    /^From:.*adeepergrey@\(excite|gmail\)\.com/ || \
    /^From:.*linuxmaier@yahoo\.com/ || \
    /^From:.*maier1@wisc\.edu/ || \
    /^From:.*maier@wi\.rr\.com/ || \
    /^From:.*maierfest@aol\.com/ || \
    /^From:.*mmaier@stewart-peterson\.com/ || \
    /^From:.*jmaier7@wi\.rr\.com/ || \
    /^From:.*pbroad@iopener\.net/ || \
    /^From:.*sharonmaier@gmail\.com/ || \
    /^From:.*tanyamohn@aol\.com/ || \
    /^From:.*wegmann@sbcglobal\.net/ )
{
    to $FAMILY
}

# --[ FRIENDS
if ( \
    /^From:.*aquaranger@hotmail\.com/ || \
    /^From:.*butterflyschmid@yahoo\.com/ || \
    /^From:.*ejburnett@.*wisc\.edu/ || \
    /^From:.*hastings.cameron@gmail\.com/ || \
    /^From:.*hitbyguitarz@yahoo\.com/ || \
    /^From:.*kafka@riseup\.net/ || \
    /^From:.*katwodtke@wi\.rr\.com/ || \
    /^From:.*kwrosenb@wisc\.edu/ || \
    /^From:.*mbrunlieb@gmail\.com/ || \
    /^From:.*mbrunlieb@hotmail\.com/ || \
    /^From:.*jolan@protection\.cx/ || \
    /^From:.*digitek@charter\.net/ || \
    /^From:.*rmainville@stewart-peterson\.com/ )
{
    to $FRIEND
}

include "$FILTERDIR/junk"
include "$FILTERDIR/work"

log "Dropping in DEFAULT"
to $DEFAULT
