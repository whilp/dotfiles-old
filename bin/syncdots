#!/bin/sh

SRC=$1

find ${SRC} -type f -o -type l \! -path "*/.hg*" -print0 | \
	xargs -n1 -r0 -i@ sh -c "\
		DST=@; \
		DST=\${DST#${SRC}}; \
		mkdir -p ${HOME}/\${DST%/*} 2>/dev/null; \
		cp @ ${HOME}/\${DST};"
