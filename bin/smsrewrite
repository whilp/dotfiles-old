#!/usr/bin/env python

from itertools import takewhile

def fmt_header(header, value=None):
    header = header.lower()
    if header == "from":
        value = [x for x in value.split() if '@' in x][0]
        value = value.strip("\"'<>")
    elif header == "subject":
        value = ' '.join(value.split()).strip()

    return header, value

is_header = lambda line: line != ''
split_header = lambda line: fmt_header(*line.split(':', 1))
get_headers = lambda stream: dict(split_header(x) for x in takewhile(is_header, stream))

template = "From: %(from)s\nSubject: %(subject)s\n\n%(subject)s"
main = lambda instream, outstream: outstream.write(template[:135] % get_headers(instream) + '\n')

if __name__ == '__main__':
    import sys
    main(sys.stdin, sys.stdout)
